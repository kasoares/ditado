{
  "version": 3,
  "sources": ["../../vuetify/src/components/VMenu/VMenu.tsx"],
  "sourcesContent": ["// Styles\nimport './VMenu.sass'\n\n// Components\nimport { VDialogTransition } from '@/components/transitions'\nimport { VDefaultsProvider } from '@/components/VDefaultsProvider'\nimport { VOverlay } from '@/components/VOverlay'\nimport { makeVOverlayProps } from '@/components/VOverlay/VOverlay'\n\n// Composables\nimport { forwardRefs } from '@/composables/forwardRefs'\nimport { useRtl } from '@/composables/locale'\nimport { useProxiedModel } from '@/composables/proxiedModel'\nimport { useScopeId } from '@/composables/scopeId'\n\n// Utilities\nimport {\n  computed,\n  inject,\n  mergeProps,\n  nextTick,\n  onBeforeUnmount,\n  onDeactivated,\n  provide,\n  ref,\n  shallowRef, toRef,\n  useId,\n  watch,\n} from 'vue'\nimport { VMenuSymbol } from './shared'\nimport {\n  focusableChildren,\n  focusChild,\n  genericComponent,\n  getNextElement,\n  IN_BROWSER,\n  isClickInsideElement,\n  omit,\n  propsFactory,\n  useRender,\n} from '@/util'\n\n// Types\nimport type { OverlaySlots } from '@/components/VOverlay/VOverlay'\n\nexport const makeVMenuProps = propsFactory({\n  // TODO\n  // disableKeys: Boolean,\n  id: String,\n  submenu: Boolean,\n  disableInitialFocus: Boolean,\n\n  ...omit(makeVOverlayProps({\n    closeDelay: 250,\n    closeOnContentClick: true,\n    locationStrategy: 'connected' as const,\n    location: undefined,\n    openDelay: 300,\n    scrim: false,\n    scrollStrategy: 'reposition' as const,\n    transition: { component: VDialogTransition },\n  }), ['absolute']),\n}, 'VMenu')\n\nexport const VMenu = genericComponent<OverlaySlots>()({\n  name: 'VMenu',\n\n  props: makeVMenuProps(),\n\n  emits: {\n    'update:modelValue': (value: boolean) => true,\n  },\n\n  setup (props, { slots }) {\n    const isActive = useProxiedModel(props, 'modelValue')\n    const { scopeId } = useScopeId()\n    const { isRtl } = useRtl()\n\n    const uid = useId()\n    const id = toRef(() => props.id || `v-menu-${uid}`)\n\n    const overlay = ref<VOverlay>()\n\n    const parent = inject(VMenuSymbol, null)\n    const openChildren = shallowRef(new Set<string>())\n    provide(VMenuSymbol, {\n      register () {\n        openChildren.value.add(uid)\n      },\n      unregister () {\n        openChildren.value.delete(uid)\n      },\n      closeParents (e) {\n        setTimeout(() => {\n          if (!openChildren.value.size &&\n            !props.persistent &&\n            (e == null || (overlay.value?.contentEl && !isClickInsideElement(e, overlay.value.contentEl)))\n          ) {\n            isActive.value = false\n            parent?.closeParents()\n          }\n        }, 40)\n      },\n    })\n\n    onBeforeUnmount(() => {\n      parent?.unregister()\n      document.removeEventListener('focusin', onFocusIn)\n    })\n    onDeactivated(() => isActive.value = false)\n\n    let focusTrapSuppressed = false\n    let focusTrapSuppressionTimeout = -1\n\n    async function onPointerdown () {\n      focusTrapSuppressed = true\n      focusTrapSuppressionTimeout = window.setTimeout(() => {\n        focusTrapSuppressed = false\n      }, 100)\n    }\n\n    async function onFocusIn (e: FocusEvent) {\n      const before = e.relatedTarget as HTMLElement | null\n      const after = e.target as HTMLElement | null\n\n      await nextTick()\n\n      if (\n        isActive.value &&\n        before !== after &&\n        overlay.value?.rootEl &&\n        overlay.value?.contentEl &&\n        // We're the menu without open submenus or overlays\n        overlay.value?.localTop &&\n        // It isn't the document or the menu body\n        ![document, overlay.value.rootEl].includes(after!) &&\n        // It isn't inside the menu body\n        !overlay.value.rootEl.contains(after)\n      ) {\n        if (focusTrapSuppressed) {\n          if (!props.openOnHover && !overlay.value.activatorEl?.contains(after)) {\n            isActive.value = false\n          }\n        } else {\n          const focusable = focusableChildren(overlay.value.contentEl)\n          focusable[0]?.focus()\n\n          document.removeEventListener('pointerdown', onPointerdown)\n        }\n      }\n    }\n\n    watch(isActive, val => {\n      if (val) {\n        parent?.register()\n        if (IN_BROWSER && !props.disableInitialFocus) {\n          document.addEventListener('pointerdown', onPointerdown)\n          document.addEventListener('focusin', onFocusIn, { once: true })\n        }\n      } else {\n        parent?.unregister()\n        if (IN_BROWSER) {\n          clearTimeout(focusTrapSuppressionTimeout)\n          document.removeEventListener('pointerdown', onPointerdown)\n          document.removeEventListener('focusin', onFocusIn)\n        }\n      }\n    }, { immediate: true })\n\n    function onClickOutside (e: MouseEvent) {\n      parent?.closeParents(e)\n    }\n\n    function onKeydown (e: KeyboardEvent) {\n      if (props.disabled) return\n\n      if (e.key === 'Tab' || (e.key === 'Enter' && !props.closeOnContentClick)) {\n        if (\n          e.key === 'Enter' &&\n          ((e.target instanceof HTMLTextAreaElement) ||\n          (e.target instanceof HTMLInputElement && !!e.target.closest('form')))\n        ) return\n        if (e.key === 'Enter') e.preventDefault()\n\n        const nextElement = getNextElement(\n          focusableChildren(overlay.value?.contentEl as Element, false),\n          e.shiftKey ? 'prev' : 'next',\n          (el: HTMLElement) => el.tabIndex >= 0\n        )\n        if (!nextElement) {\n          isActive.value = false\n          overlay.value?.activatorEl?.focus()\n        }\n      } else if (props.submenu && e.key === (isRtl.value ? 'ArrowRight' : 'ArrowLeft')) {\n        isActive.value = false\n        overlay.value?.activatorEl?.focus()\n      }\n    }\n\n    function onActivatorKeydown (e: KeyboardEvent) {\n      if (props.disabled) return\n\n      const el = overlay.value?.contentEl\n      if (el && isActive.value) {\n        if (e.key === 'ArrowDown') {\n          e.preventDefault()\n          e.stopImmediatePropagation()\n          focusChild(el, 'next')\n        } else if (e.key === 'ArrowUp') {\n          e.preventDefault()\n          e.stopImmediatePropagation()\n          focusChild(el, 'prev')\n        } else if (props.submenu) {\n          if (e.key === (isRtl.value ? 'ArrowRight' : 'ArrowLeft')) {\n            isActive.value = false\n          } else if (e.key === (isRtl.value ? 'ArrowLeft' : 'ArrowRight')) {\n            e.preventDefault()\n            focusChild(el, 'first')\n          }\n        }\n      } else if (\n        props.submenu\n          ? e.key === (isRtl.value ? 'ArrowLeft' : 'ArrowRight')\n          : ['ArrowDown', 'ArrowUp'].includes(e.key)\n      ) {\n        isActive.value = true\n        e.preventDefault()\n        setTimeout(() => setTimeout(() => onActivatorKeydown(e)))\n      }\n    }\n\n    const activatorProps = computed(() =>\n      mergeProps({\n        'aria-haspopup': 'menu',\n        'aria-expanded': String(isActive.value),\n        'aria-controls': id.value,\n        'aria-owns': id.value,\n        onKeydown: onActivatorKeydown,\n      }, props.activatorProps)\n    )\n\n    useRender(() => {\n      const overlayProps = VOverlay.filterProps(props)\n\n      return (\n        <VOverlay\n          ref={ overlay }\n          id={ id.value }\n          class={[\n            'v-menu',\n            props.class,\n          ]}\n          style={ props.style }\n          { ...overlayProps }\n          v-model={ isActive.value }\n          absolute\n          activatorProps={ activatorProps.value }\n          location={ props.location ?? (props.submenu ? 'end' : 'bottom') }\n          onClick:outside={ onClickOutside }\n          onKeydown={ onKeydown }\n          { ...scopeId }\n        >\n          {{\n            activator: slots.activator,\n            default: (...args) => (\n              <VDefaultsProvider root=\"VMenu\">\n                { slots.default?.(...args) }\n              </VDefaultsProvider>\n            ),\n          }}\n        </VOverlay>\n      )\n    })\n\n    return forwardRefs({ id, ΨopenChildren: openChildren }, overlay)\n  },\n})\n\nexport type VMenu = InstanceType<typeof VMenu>\n"],
  "mappings": "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",
  "names": ["makeVMenuProps", "propsFactory", "id", "String", "submenu", "Boolean", "disableInitialFocus", "omit", "makeVOverlayProps", "closeDelay", "closeOnContentClick", "locationStrategy", "location", "undefined", "openDelay", "scrim", "scrollStrategy", "transition", "component", "VDialogTransition", "VMenu", "genericComponent", "name", "props", "emits", "value", "setup", "_ref", "slots", "isActive", "useProxiedModel", "scopeId", "useScopeId", "isRtl", "useRtl", "uid", "useId", "toRef", "overlay", "ref", "parent", "inject", "VMenuSymbol", "openChildren", "shallowRef", "Set", "provide", "register", "add", "unregister", "delete", "closeParents", "e", "setTimeout", "size", "persistent", "contentEl", "isClickInsideElement", "onBeforeUnmount", "document", "removeEventListener", "onFocusIn", "onDeactivated", "focusTrapSuppressed", "focusTrapSuppressionTimeout", "onPointerdown", "window", "before", "relatedTarget", "after", "target", "nextTick", "rootEl", "localTop", "includes", "contains", "openOnHover", "activatorEl", "focusable", "focusableChildren", "focus", "watch", "val", "IN_BROWSER", "addEventListener", "once", "clearTimeout", "immediate", "onClickOutside", "onKeydown", "disabled", "key", "HTMLTextAreaElement", "HTMLInputElement", "closest", "preventDefault", "nextElement", "getNextElement", "shiftKey", "el", "tabIndex", "onActivatorKeydown", "stopImmediatePropagation", "focusChild", "activatorProps", "computed", "mergeProps", "useRender", "overlayProps", "VOverlay", "filterProps", "_createVNode", "_mergeProps", "class", "style", "$event", "activator", "default", "_len", "arguments", "length", "args", "Array", "_key", "VDefaultsProvider", "forwardRefs", "ΨopenChildren"]
}
