import{O as B,r as u,y as E,S as U,v as z,c,w as a,f as F,a as D,o as d,d as s,T as h,W as y,l as O,$ as R,i as t,h as G,U as J,I as w,m as x,q as M,j as _,G as P,ad as $,H as j,J as q,a0 as H,A as W,B as X,g as k,F as K,t as f,C as Q,E as Y,X as Z,ae as ee,af as ae,M as se}from"./index-DuZrF_tf.js";import{t as S}from"./turmaService-BLHpVfEt.js";const oe={key:1},le={class:"d-flex align-center gap-2"},ie={__name:"InsertAluno",setup(te){const C=D(),b=B().params.turmaId,p=u([]),g=u([]),r=u([]),i=u(""),m=u(!1),v=u(!1),n=u({show:!1,mensagem:"",color:"success"}),I=E(()=>p.value.filter(l=>l.nome.toLowerCase().includes(i.value.toLowerCase())||l.login.toLowerCase().includes(i.value.toLowerCase())));function V(l,e="success"){n.value.mensagem=l,n.value.color=e,n.value.show=!0}U(async()=>{await L()});async function L(){m.value=!0;try{const l=await S.buscarPorId(b);g.value=l.alunosIds||[];const e=await z.listarTodos();p.value=e.filter(o=>o.tipo==="Aluno"),r.value=[...g.value]}catch(l){console.error("Erro ao carregar dados:",l),V("Erro ao carregar dados","error")}finally{m.value=!1}}function A(l){const e=r.value.indexOf(l);e>-1?r.value.splice(e,1):r.value.push(l)}async function N(){var l,e;v.value=!0;try{await S.atualizar(b,{alunosIds:r.value}),V("Alunos adicionados com sucesso!","success"),setTimeout(()=>{C.push("/turmas")},1500)}catch(o){console.error("Erro ao salvar alunos:",o),V(((e=(l=o.response)==null?void 0:l.data)==null?void 0:e.message)||"Erro ao salvar alunos","error")}finally{v.value=!1}}function T(){C.push("/turmas")}return(l,e)=>(d(),c(F,{class:"py-6"},{default:a(()=>[s(h,null,{default:a(()=>[s(y,{cols:"12"},{default:a(()=>[s(O,{elevation:"0",class:"mb-6"},{default:a(()=>[s(R,{class:"bg-primary text-white pa-4"},{default:a(()=>[s(G,{class:"mr-2"},{default:a(()=>[...e[2]||(e[2]=[t("mdi-account-plus",-1)])]),_:1}),e[3]||(e[3]=t(" Gerenciar Alunos ",-1))]),_:1}),s(J,{class:"pa-6"},{default:a(()=>[s(h,{class:"mb-6"},{default:a(()=>[s(y,{cols:"12",md:"8"},{default:a(()=>[s(M,{modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=o=>i.value=o),label:"Buscar aluno",placeholder:"Nome do aluno","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"comfortable"},null,8,["modelValue"])]),_:1}),s(y,{cols:"12",md:"4",class:"d-flex align-center gap-2"},{default:a(()=>[s(_,{color:"success",disabled:v.value,loading:v.value,onClick:N,class:"text-none","prepend-icon":"mdi-check"},{default:a(()=>[...e[4]||(e[4]=[t(" Salvar ",-1)])]),_:1},8,["disabled","loading"]),s(_,{variant:"outlined",onClick:T,class:"text-none"},{default:a(()=>[...e[5]||(e[5]=[t(" Cancelar ",-1)])]),_:1})]),_:1})]),_:1}),s(P,{class:"my-4"}),m.value?(d(),c($,{key:0,indeterminate:"",color:"primary",class:"mb-4"})):p.value.length>0?(d(),w("div",oe,[s(j,{class:"bg-transparent"},{default:a(()=>[(d(!0),w(q,null,H(I.value,o=>(d(),c(W,{key:o.id,class:X(["mb-2 rounded border",{"bg-green-lighten-5":r.value.includes(o.id)}])},{prepend:a(()=>[s(ee,{"model-value":r.value.includes(o.id),onChange:ne=>A(o.id),density:"compact",class:"mr-2"},null,8,["model-value","onChange"])]),append:a(()=>[g.value.includes(o.id)?(d(),c(Z,{key:0,color:"success","text-color":"white",size:"small","prepend-icon":"mdi-check"},{default:a(()=>[...e[6]||(e[6]=[t(" Na turma ",-1)])]),_:1})):x("",!0)]),default:a(()=>[k("div",le,[s(K,{size:"40",color:"primary","text-color":"white"},{default:a(()=>[t(f(o.nome.charAt(0).toUpperCase()),1)]),_:2},1024),k("div",null,[s(Q,{class:"font-weight-bold"},{default:a(()=>[t(f(o.nome),1)]),_:2},1024),s(Y,null,{default:a(()=>[t(f(o.login),1)]),_:2},1024)])])]),_:2},1032,["class"]))),128))]),_:1})])):m.value?x("",!0):(d(),c(ae,{key:2,headline:"Nenhum aluno encontrado",title:"Sem resultados",text:i.value?"Não há alunos com o filtro selecionado":"Não há alunos cadastrados no sistema",icon:"mdi-account-search"},null,8,["text"]))]),_:1})]),_:1})]),_:1})]),_:1}),s(se,{modelValue:n.value.show,"onUpdate:modelValue":e[1]||(e[1]=o=>n.value.show=o),color:n.value.color,timeout:3e3},{default:a(()=>[t(f(n.value.mensagem),1)]),_:1},8,["modelValue","color"])]),_:1}))}};export{ie as default};
