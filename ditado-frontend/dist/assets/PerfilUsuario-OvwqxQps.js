import{_ as q,u as R,r as s,y as G,P as W,I as X,d as a,w as l,l as I,a2 as H,a as J,o as S,a0 as N,g as n,h as K,i as u,W as T,c as z,m as D,n as L,p as O,U as B,X as m,F as Q,t as E,q as g,G as P,j as V,s as U,a4 as Y,S as Z,v as _}from"./index-BdFIb-Ra.js";const ee={class:"d-flex align-center"},ae={class:"text-h3 text-md-h2 text-white font-weight-bold"},le={__name:"PerfilUsuario",setup(te){const $=J(),i=R(),d=s({nome:"",email:""}),r=s(""),C=s(""),x=s(!1),y=s(!1),k=s(!1),w=s(!1),v=s(null),f=s(null),A=s(null),p=s(!1),c={obrigatorio:o=>!!o||"Campo obrigatório",email:o=>/.+@.+\..+/.test(o)||"Email inválido",senhaMinima:o=>!o||o.length>=6||"Senha deve ter no mínimo 6 caracteres",senhasIguais:o=>o===r.value||"As senhas não conferem"},j=G(()=>(d.value.nome||"AT").split(" ").map(e=>e[0]).join("").substring(0,2).toUpperCase());W(()=>{i.usuario&&(d.value={nome:i.usuario.nome,email:i.usuario.email})});async function M(){var e,t;const{valid:o}=await A.value.validate();if(o){k.value=!0,v.value=null,f.value=null;try{const b={...d.value};r.value&&(b.senha=r.value),await i.atualizarUsuario(i.usuario.id,b),f.value="Perfil atualizado com sucesso!",r.value="",C.value=""}catch(b){v.value=((t=(e=b.response)==null?void 0:e.data)==null?void 0:t.message)||"Erro ao atualizar perfil"}finally{k.value=!1}}}function F(){p.value=!0}async function h(){var o,e;w.value=!0;try{await _.deletar(i.usuario.id),i.logout(),$.push("/login")}catch(t){v.value=((e=(o=t.response)==null?void 0:o.data)==null?void 0:e.message)||"Erro ao excluir conta",p.value=!1}finally{w.value=!1}}return(o,e)=>(S(),X("div",null,[a(I,{elevation:"1",class:"mx-auto","max-width":"900"},{default:l(()=>[a(N,{class:"pa-4 pa-md-6 bg-grey-lighten-5 border-b"},{default:l(()=>[n("div",ee,[a(K,{class:"mr-2 mr-md-3",color:"grey-darken-2"},{default:l(()=>[...e[10]||(e[10]=[u("mdi-account-edit",-1)])]),_:1}),e[11]||(e[11]=n("span",{class:"text-body-1 text-md-h6 font-weight-bold"},"Editar Perfil",-1))])]),_:1}),a(T,{class:"pa-4 pa-md-8"},{default:l(()=>[a(L,{onSubmit:O(M,["prevent"]),ref_key:"formulario",ref:A},{default:l(()=>[a(B,null,{default:l(()=>[a(m,{cols:"12",class:"text-center mb-2 mb-md-4"},{default:l(()=>[a(Q,{color:"primary",size:"100","size-md":"120"},{default:l(()=>[n("span",ae,E(j.value),1)]),_:1})]),_:1}),a(m,{cols:"12"},{default:l(()=>[e[12]||(e[12]=n("label",{class:"text-body-2 text-grey-darken-2 mb-2 d-block"}," Nome completo ",-1)),a(g,{modelValue:d.value.nome,"onUpdate:modelValue":e[0]||(e[0]=t=>d.value.nome=t),placeholder:"Digite seu nome",variant:"outlined",density:"comfortable",rules:[c.obrigatorio],"hide-details":"auto"},null,8,["modelValue","rules"])]),_:1}),a(m,{cols:"12"},{default:l(()=>[e[13]||(e[13]=n("label",{class:"text-body-2 text-grey-darken-2 mb-2 d-block"}," Email ",-1)),a(g,{modelValue:d.value.email,"onUpdate:modelValue":e[1]||(e[1]=t=>d.value.email=t),placeholder:"seu@email.com",type:"email",variant:"outlined",density:"comfortable",rules:[c.obrigatorio,c.email],"hide-details":"auto"},null,8,["modelValue","rules"])]),_:1}),a(m,{cols:"12"},{default:l(()=>[a(P,{class:"my-2 my-md-4"}),e[14]||(e[14]=n("h3",{class:"text-body-1 text-md-h6 font-weight-bold mb-3 mb-md-4"},"Alterar Senha",-1))]),_:1}),a(m,{cols:"12",md:"6"},{default:l(()=>[e[15]||(e[15]=n("label",{class:"text-body-2 text-grey-darken-2 mb-2 d-block"}," Nova senha ",-1)),a(g,{modelValue:r.value,"onUpdate:modelValue":e[2]||(e[2]=t=>r.value=t),placeholder:"Deixe em branco para não alterar",type:x.value?"text":"password",variant:"outlined",density:"comfortable","append-inner-icon":x.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":e[3]||(e[3]=t=>x.value=!x.value),rules:r.value?[c.senhaMinima]:[],"hide-details":"auto"},null,8,["modelValue","type","append-inner-icon","rules"])]),_:1}),a(m,{cols:"12",md:"6"},{default:l(()=>[e[16]||(e[16]=n("label",{class:"text-body-2 text-grey-darken-2 mb-2 d-block"}," Confirmar nova senha ",-1)),a(g,{modelValue:C.value,"onUpdate:modelValue":e[4]||(e[4]=t=>C.value=t),placeholder:"Confirme a nova senha",type:y.value?"text":"password",variant:"outlined",density:"comfortable","append-inner-icon":y.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":e[5]||(e[5]=t=>y.value=!y.value),rules:r.value?[c.senhasIguais]:[],"hide-details":"auto"},null,8,["modelValue","type","append-inner-icon","rules"])]),_:1})]),_:1}),a(P,{class:"my-4 my-md-6"}),a(B,null,{default:l(()=>[a(m,{cols:"12",class:"d-flex flex-column flex-sm-row justify-end gap-2"},{default:l(()=>[a(V,{color:"error",variant:"outlined",onClick:F,class:"text-none","prepend-icon":"mdi-delete"},{default:l(()=>[...e[17]||(e[17]=[u(" Excluir Conta ",-1)])]),_:1}),a(V,{type:"submit",color:"primary",loading:k.value,class:"text-none","prepend-icon":"mdi-content-save"},{default:l(()=>[...e[18]||(e[18]=[u(" Salvar Alterações ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},512),v.value?(S(),z(U,{key:0,type:"error",class:"mt-4",variant:"tonal",closable:"","onClick:close":e[6]||(e[6]=t=>v.value=null)},{default:l(()=>[u(E(v.value),1)]),_:1})):D("",!0),f.value?(S(),z(U,{key:1,type:"success",class:"mt-4",variant:"tonal",closable:"","onClick:close":e[7]||(e[7]=t=>f.value=null)},{default:l(()=>[u(E(f.value),1)]),_:1})):D("",!0)]),_:1})]),_:1}),a(H,{modelValue:p.value,"onUpdate:modelValue":e[9]||(e[9]=t=>p.value=t),"max-width":"500"},{default:l(()=>[a(I,null,{default:l(()=>[a(N,{class:"pa-4 pa-md-6 bg-error text-white"},{default:l(()=>[...e[19]||(e[19]=[n("span",{class:"text-body-1 text-md-h6 font-weight-bold"},"Confirmar Exclusão",-1)])]),_:1}),a(T,{class:"pa-4 pa-md-6"},{default:l(()=>[e[21]||(e[21]=n("p",{class:"text-body-2 text-md-body-1 mb-4"}," Tem certeza que deseja excluir sua conta? Esta ação não pode ser desfeita. ",-1)),a(U,{type:"warning",variant:"tonal",density:"compact"},{default:l(()=>[...e[20]||(e[20]=[u(" Todos os seus dados serão permanentemente removidos. ",-1)])]),_:1})]),_:1}),a(Y,{class:"pa-4"},{default:l(()=>[a(Z),a(V,{color:"grey",variant:"text",onClick:e[8]||(e[8]=t=>p.value=!1),class:"text-none"},{default:l(()=>[...e[22]||(e[22]=[u(" Cancelar ",-1)])]),_:1}),a(V,{color:"error",variant:"flat",loading:w.value,onClick:h,class:"text-none"},{default:l(()=>[...e[23]||(e[23]=[u(" Excluir Conta ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}},se=q(le,[["__scopeId","data-v-ca15e7c6"]]);export{se as default};
